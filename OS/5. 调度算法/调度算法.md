[TOC]
<img width="237" alt="image" src="https://github.com/Lxieshan/interView/assets/48934924/07b7d4ed-cb16-477d-9460-9928e0f1321e">

调度算法

![本文提纲](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%E6%8F%90%E7%BA%B2.png)

## 5.1 调度分类

- **非抢占式调度**    **工作中 为非抢占式**
  - 当进程正在运行时，它就会一直运行，直到该进程完成或发生某个事件而被阻塞时，才会把 CPU 让给其他进程
  - **非抢占式调度有**：
    - 当进程从运行状态转到等待状态；
    - 当进程从运行状态转到终止状态；
- **抢占式调度**   **待工作  为抢占式**
  - 进程正在运行的时，可以被打断，使其把 CPU 让给其他进程
  - **抢占式调度有**：
    - 当进程从运行状态转到就绪状态；
    - 当进程从等待状态转到就绪状态；
  - **抢占式分类**
    - 时间片原则
    - 优先权原则
    - 短作业优先原则

## 5.2 进程调度算法

- 抢占式

  - **最短作业优先**（**shortest job first ,SJF**）

    ![SJF 调度算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/25-%E6%9C%80%E7%9F%AD%E4%BD%9C%E4%B8%9A%E4%BC%98%E5%85%88%E7%AE%97%E6%B3%95.jpg)

  - **高响应比优先调用** （**Highest Response Ratio Next, HRRN**）

    ![img](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/26-%E5%93%8D%E5%BA%94%E6%AF%94%E5%85%AC%E5%BC%8F.jpg)

  - **时间片轮转** （**Round Robin, RR**）

    ![RR 调度算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/27-%E6%97%B6%E9%97%B4%E7%89%87%E8%BD%AE%E8%AF%A2.jpg)

  - **最高优先级调度算法**

    - **抢占式**
      - 抢占式
        - 当就绪队列中出现优先级高的进程，当前进程挂起，调度优先级高的进程运行。
      - 非抢占式
        - 当就绪队列中出现优先级高的进程，运行完当前进程，再选择优先级高的进程。
    - **优先级确定**
      - 静态优先级
        - 创建进程时候，就已经确定了优先级了，然后整个运行时间优先级都不会变化；
      - 动态优先级
        - 根据进程的动态变化调整优先级，比如如果进程运行时间增加，则降低其优先级，如果进程等待时间（就绪队列的等待时间）增加，则升高其优先级，也就是**随着时间的推移增加等待进程的优先级**。

  - **多级反馈队列调度算法** （**Multilevel Feedback Queue**）

    - 「多级」表示有多个队列，每个队列优先级从高到低，同时优先级越高时间片越短。
    - 「反馈」表示如果有新的进程加入优先级高的队列时，立刻停止当前正在运行的进程，转而去运行优先级高的队列；
    - ![多级反馈队列](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/28-%E5%A4%9A%E7%BA%A7%E9%98%9F%E5%88%97.jpg)

  - ​	

- 非抢占式
  - 先来先服务 （**First Come First Severd, FCFS**）
    - ![FCFS 调度算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/24-%E5%85%88%E6%9D%A5%E5%85%88%E6%9C%8D%E5%8A%A1.jpg)

## 5.3 页面置换算法

- 虚拟内存访问流程

  ![虚拟内存的流程](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%B5%81%E7%A8%8B.png)

当 缺页中断时， 启动页面置换算法



### 5.3.1 最佳页面置换算法  (OPT)

- 最佳页面置换算法基本思路是，**置换在「未来」最长时间不访问的页面**。

  ![最佳页面置换算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E6%9C%80%E4%BC%98%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95.png)

### 5.3.2 先进先出置换算法 (FIFO)

「先进先出置换」算法的思想： **选择在内存驻留时间很长的页面进行中置换**

![先进先出置换算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/FIFO%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95.png)

### 5.3.3 最近最久未使用算法 (LRU)

最近最久未使用（*LRU*）的置换算法的基本思路是，发生缺页时，**选择最长时间没有被访问的页面进行置换**，

![最近最久未使用的置换算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/LRU%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95.png)

### 5.3.4 时钟页面置换算法

该算法的思路是，把所有的页面都保存在一个类似钟面的「环形链表」中，一个表针指向最老的页面。

- 如果它的访问位位是 0 就淘汰该页面，并把新的页面插入这个位置，然后把表针前移一个位置；
- 如果访问位是 1 就清除访问位，并把表针前移一个位置，重复这个过程直到找到了一个访问位为 0 的页面为止；

![时钟页面置换算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E6%97%B6%E9%92%9F%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95.png)

### 5.3.5 最不常用 

**当发生缺页中断时，选择「访问次数」最少的那个页面，并将其淘汰**。

## 5.4 磁盘调度算法

### 5.4.1 先来先服务

![先来先服务](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E7%A3%81%E7%9B%98%E8%B0%83%E5%BA%A6-%E5%85%88%E6%9D%A5%E5%85%88%E6%9C%8D%E5%8A%A1.png)

先来先服务算法总共移动了 `640` 个磁道的距离  **简单粗暴， 效率不佳**

### 5.4.2 最短寻道时间优先

![最短寻道时间优先](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E7%A3%81%E7%9B%98%E8%B0%83%E5%BA%A6-%E6%9C%80%E7%9F%AD%E5%AF%BB%E9%81%93%E6%97%B6%E9%97%B4%E4%BC%98%E5%85%88.png)

磁头移动的总距离是 `236` 磁道

**缺点**：

易发生 饥饿 现象， 有些磁道存在 一直不被访问的风险

### 5.4.3 扫描算法



![扫描算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E7%A3%81%E7%9B%98%E8%B0%83%E5%BA%A6-%E6%89%AB%E6%8F%8F%E7%AE%97%E6%B3%95.png)

磁头先响应左边的请求，直到到达最左端（ 0 磁道）后，才开始反向移动，响应右边的请求。

**优点**：

不会发生饥饿

**缺点**：

中间访问频率 优于 两边

### 5.4.4 循环扫描算法

![循环扫描算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E7%A3%81%E7%9B%98%E8%B0%83%E5%BA%A6-C-SCAN%E7%AE%97%E6%B3%95.png)

磁头先响应了右边的请求，直到碰到了最右端的磁道 199，就立即回到磁盘的开始处（磁道 0），但这个返回的途中是不响应任何请求的，直到到达最开始的磁道后，才继续顺序响应右边的请求。



**优点**：
 对各个磁道的访问频率 相对平均

### 5.4.5 LOOK 与 C-LOOK算法

**区别在于 ：返回途中 是否处理请求**

![LOOK 算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E7%A3%81%E7%9B%98%E8%B0%83%E5%BA%A6-LOOK%E7%AE%97%E6%B3%95.png)

**优点**：

限制 最远移动 范围

![C-LOOK 算法](./%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95.assets/%E7%A3%81%E7%9B%98%E8%B0%83%E5%BA%A6-C-LOOK%E7%AE%97%E6%B3%95.png)
